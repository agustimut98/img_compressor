<launch>


  <arg name="bagfile" default="/home/agusti/Descargas/perAgusti/images_2020-12-03-14-45-17_1.bag"/>


  <param name="/use_sim_time" value="true"/>
  <arg name="camera" default="/stereo_down"/>

  <node pkg="rosbag" type="play" name="rosbag" args="--clock $(arg bagfile) -r 0.5" />

  <node pkg="odometry2range" type="odometry2range" name="odometry2range" output="screen">
    <remap from="odometry" to="/turbot/navigator/altitude/ekf_alt/odometry"/>
    <remap from="Range" to="/turbot/navigator/altitude_EKF_filtered"/>
  </node>

  
  <include file="/home/agusti/catkin_ws/src/cirtesu_common_python_img_compressor/launch/stereo_3D.launch">
    <arg name="camera1" value="$(arg camera)" />
  </include>

  <!--node pkg="image_preprocessing" type="stereo_clahs_node" name="stereo_clahs_node" respawn="true" output="screen" >
    <remap from="stereo" to="$(arg camera)/scaled_x2"/>
  </node-->

  <node pkg="image_preprocessing" type="color_correction_image" name="color_correction_image_left" output="screen">
    <remap from="/color_correction_image/input" to="$(arg camera)/scaled_x4/left/image_rect_color"/>
    <remap from="/color_correction_image/output" to="/clahe/scaled_x4/left/image_rect_color_corrected"/>
  </node>

  <node pkg="uware" type="preprocess" name="preprocess" output="screen">
    <param name="odom_topic" value="/turbot/navigator/ekf_odom/odometry"/>
    <param name="map_topic" value="/turbot/navigator/ekf_map/odometry"/>
    <param name="camera_left_topic" value="/clahe/scaled_x4/left/image_rect_color_corrected"/>
    <!--param name="camera_left_topic" value="$(arg camera)/scaled_x2/left/image_rect_color"/-->
    <param name="camera_right_topic" value="$(arg camera)/scaled_x4/right/image_rect_color"/>
    <param name="camera_right_info" value="$(arg camera)/scaled_x4/right/camera_info"/>
    <param name="camera_left_info" value="$(arg camera)/scaled_x4/left/camera_info"/>
    <param name="camera_topic_points2" value="$(arg camera)/scaled_x4/points2"/>
    <param name="altitude_topic" value="/turbot/navigator/altitude_EKF_filtered"/>
    <param name="navstatus_topic" value="/turbot/navigator/navigation"/>
    <param name="min_cloud_size" value="400"/>
    <param name="store_distance" value="0.70"/>
    <param name="outdir" value="/home/agusti/Descargas/perAgusti/preprocess"/>

  </node>


</launch>
